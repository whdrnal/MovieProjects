{% extends "layout.html" %}
{% load humanize %}
{% load django_bootstrap5 %}
{%block content %}

<section class="col-12 col-lg-auto me-lg-auto" style="border-radius:5px">
    <div class="t-flex t-justify-center">
        <img class="t-w-[26rem] t-mt-[6rem]"  style="border-radius:5px" src="{{movie.thumb_img_url}}" alt="">
    </div>
    <div class="t-flex t-justify-center t-mt-[0.5rem]">
        {{ movie.display_name }} <br>
        개봉날짜 : {{ movie.open_day }} <br>
        영화감독 : {{ movie.director_name}} <br>
        {{ movie.genre }} <br>
    </div>

    <hr class="t-mt-[1.3rem]">
    <div class="t-px-[1rem] t-mt-[1.5rem]">
        <div class="t-mt-[1rem]">
            {% if user.is_authenticated %}
            {%else%}
            <a class="t-text-red-500 hover:t-text-red-500" href="{% url 'common:login' %}?next={{request.get_full_path}}">로그인</a> 후 리뷰 작성을 할수 있습니다.
            {%endif%}
        </div>
        <div class="t-mt-[1rem]">
            {{  movie.question_list }}

            {% if movie.question_set.count == 0 %}
            <p class="t-text-red-500">리뷰가 없습니다.</p>

            {% else %}
            <div class="t-flex t-justify-center">
                <p class="t-text-blue-500"> {{ movie.question_set.count }} </p>
                <spen>　개의 리뷰 평점이 있습니다.</spen>
            </div>

            {% endif %}
        </div>
        <ul class="list-group">
            {% for question in question_list %}
            <li class="list-group-item" style="border-radius:5px">
                <div class="">
                    <div class="t-text-sm">
                        {{ question.create_date}} <br>
                         {% if question.score == 10 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                         {% if question.score == 9 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                         {% if question.score == 8 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                         {% if question.score == 7 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                         {% if question.score == 6 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 5 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 4 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 3 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 2 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 1 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                    </div>
                    <p class="t-flex t-items-center t-mt-[2rem]" href="#">
                        <img src="https://ifh.cc/g/KUL8gO.png" alt="">
                        <span class="t-ml-[1rem]">{{ question.user }}님</span>
                    </p>
                </div>
                <div class="container t-flex t-flex-col lg:t-flex-row t-justify-center t-mt-[4rem]">
                    <div style=" word-break:break-all;">

                        <span>{{ question.content }}</span>

                    </div>
                </div>
                <div class="t-flex t-mt-[5rem]">
                    {% if question.user == request.user %}
                    <a href="{% url 'mv:question_delete' movie.id question.id %}" class="btn btn-outline-danger" onclick="if ( confirm('정말 삭제하시겠습니까?') == false ) return false;">삭제</a>
                    {% endif %}
                    &nbsp;
                    {% if question.user == request.user %}
                    <a href="{% url 'mv:question_modify' movie.id question.id %}" class="btn btn-outline-secondary">수정</a>
                    {% endif %}
                </div>
            </li>
            <hr style="height:0.1px">
            {% endfor %}
        </ul>
    </div>

    <div class="t-text-sm">
        <i class="fas fa-exclamation-triangle t-text-red-500"></i><br>
        여러분의 소중한 평점 및 영화 관람평을 작성해주세요.<br>
        주제와 무관한 리뷰 또는 스포일러는 표시제한 또는 삭제될 수 있습니다.
    </div>

    <div class="t-mt-[1rem]">
        {% if user.is_authenticated %}
        <form method="POST" action="{% url 'mv:question_create' movie.id %}">
            {% csrf_token %}

            {% bootstrap_form form %}

            <select class="t-mb-3 t-text-black t-ml-[10px] score t-text-yellow-500" name="score" id="score" style="border-radius:5px">
                <option value="1">★ (1점)</option>
                <option value="2">★★ (2점)</option>
                <option value="3">★★★ (3점)</option>
                <option value="4">★★★★ (4점)</option>
                <option value="5">★★★★★ (5점)</option>
                <option value="6">★★★★★★ (6점)</option>
                <option value="7">★★★★★★★ (7점)</option>
                <option value="8">★★★★★★★★ (8점)</option>
                <option value="9">★★★★★★★★★ (9점)</option>
                <option value="10">★★★★★★★★★★ (10점)</option>
            </select><br>

            <button type="submit" class="btn btn-primary mb-2 reviewSubmit">
                리뷰 작성
            </button>
        </form>
        {% endif %}
    </div>
    <br>
    <br>
    </div>
    <script type='text/javascript'>
$(document).ready(function(){
    $(".delete").on('click', function() {
        if(confirm("정말로 삭제하시겠습니까?")) {
            location.href = $(this).data('uri');
        }
    });
    $(".recommend").on('click', function() {
        if(confirm("정말로 추천하시겠습니까?")) {
            location.href = $(this).data('uri');
        }
    });
});
</script>
</section>
{% endblock %}
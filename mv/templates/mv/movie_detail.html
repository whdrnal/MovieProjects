{% extends "layout.html" %}
{% load humanize %}
{% load django_bootstrap5 %}
{%block content %}


<section class="col-12 col-lg-auto me-lg-auto" style="border-radius:5px">
    <div class="t-flex t-justify-center">
        <img class="t-w-[21.5rem] t-mt-[2rem]"  style="border-radius:5px" src="{{movie.thumb_img_url}}" alt="">
    </div>
    <div class="t-mt-[3rem] t-text-black">
        <a class="t-text-blue-500" href="{% url 'common:login' %}?next={{request.get_full_path}}">로그인</a> 후 리뷰 작성을 할수 있습니다.
    </div>
    <div class="t-text-black">
        <p class="t-mt-[10px] t-ml-[1rem]">리뷰 <span class="t-text-red-500">{{ movie.question_set.count }}</span> ꒐
            추천 <a class="far fa-thumbs-up t-text-blue-500" href="{% url 'mv:vote_movie' movie.id %}">
            </a> {{movie.voter.count}}
        </p>
        <div class="t-mt-[1rem]">여러분의 소중한 리뷰를 남겨주세요.</div>
    </div>
    <div class="t-px-[1rem] t-mt-[30px]">
        <ul class="list-group">
            {% for question in question_list %}
            <li class="list-group-item" style="border-radius:5px">
                <div class="">
                    <div class="t-text-sm">
                        {{ question.create_date }}
                    </div>
                    <a class="t-flex t-items-center t-mt-[2rem]" href="#">
                        <img src="https://ifh.cc/g/KUL8gO.png" alt="">
                        <span class="t-ml-[1rem]">{{ question.user }}님</span>
                    </a>
                </div>
                <div class="t-container t-flex t-flex-col lg:t-flex-row t-items-center t-mt-[4rem]">
                    <div>
                        <span>
                            {{ question.content }}
                        </span>
                    </div>
                </div>
                <div class="t-flex t-mt-[5rem]">
                    {% if question.user == request.user %}
                    <a href="{% url 'mv:question_delete' movie.id question.id %}" class="btn btn-outline-danger" onclick="if ( confirm('정말 삭제하시겠습니까?') == false ) return false;">삭제</a>
                    {% endif %}
                    &nbsp;
                    {% if question.user == request.user %}
                    <a href="{% url 'mv:question_modify' movie.id question.id %}" class="btn btn-outline-secondary">수정</a>
                    {% endif %}
                </div>
            </li>
            <hr style="height:0.1px">
            {% endfor %}
        </ul>
    </div>
    <div>
        {% if user.is_authenticated %}
        <form method="POST" action="{% url 'mv:question_create' movie.id %}">
            {% csrf_token %}
            {% bootstrap_form form %}
            {% bootstrap_button button_type="submit" content="리뷰작성" %}
        </form>
        {% endif %}
    </div>
    <br>
    </div>

    <script type='text/javascript'>
$(document).ready(function(){
    $(".delete").on('click', function() {
        if(confirm("정말로 삭제하시겠습니까?")) {
            location.href = $(this).data('uri');
        }
    });
    $(".recommend").on('click', function() {
        if(confirm("정말로 추천하시겠습니까?")) {
            location.href = $(this).data('uri');
        }
    });
});
</script>
</section>
{% endblock %}

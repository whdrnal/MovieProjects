{% extends "layout.html" %}
{% load humanize %}
{% load django_bootstrap5 %}
{%block content %}

<section class="col-12 col-lg-auto me-lg-auto" style="border-radius:5px">
    <div class="t-flex t-justify-center">
        <img class="t-w-[26rem] t-mt-[6rem]"  style="border-radius:5px" src="{{movie.thumb_img_url}}" alt="">
    </div>
    <div class="t-mt-[1rem]">
        {% if user.is_authenticated %}
        {%else%}
        <a href="{% url 'common:login' %}?next={{request.get_full_path}}">로그인</a> 후 리뷰 작성을 할수 있습니다.
        {%endif%}
    </div>
    <div>
        <p class="t-mt-[10px] t-ml-[1rem]">리뷰 수 <span class="t-text-blue-500">{{ movie.question_set.count }}</span><!-- ꒐-->
            <!--            추천 <a class="far fa-thumbs-up t-text-blue-500" href="{% url 'mv:vote_movie' movie.id %}">
                        </a> {{movie.voter.count}}-->
        </p>
    </div>
    <div class="t-px-[1rem] t-mt-[30px]">
        <ul class="list-group">
            {% for question in question_list %}
            <li class="list-group-item" style="border-radius:5px">
                <div class="">
                    <div class="t-text-sm">
                        {{ question.create_date}} <br>
                        {% if question.score == 5 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 4 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 3 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 2 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                        {% if question.score == 1 %}
                        <i class="fas fa-star t-text-yellow-500"></i>
                        {% endif %}
                    </div>
                    <a class="t-flex t-items-center t-mt-[2rem]" href="#">
                        <img src="https://ifh.cc/g/KUL8gO.png" alt="">
                        <span class="t-ml-[1rem]">{{ question.user }}님</span>
                    </a>
                </div>
                <div class="container t-flex t-flex-col lg:t-flex-row t-justify-center t-mt-[4rem]">
                    <div style=" word-break:break-all;">

                        <span>{{ question.content }}</span>

                    </div>
                </div>
                <div class="t-flex t-mt-[5rem]">
                    {% if question.user == request.user %}
                    <a href="{% url 'mv:question_delete' movie.id question.id %}" class="btn btn-outline-danger" onclick="if ( confirm('정말 삭제하시겠습니까?') == false ) return false;">삭제</a>
                    {% endif %}
                    &nbsp;
                    {% if question.user == request.user %}
                    <a href="{% url 'mv:question_modify' movie.id question.id %}" class="btn btn-outline-secondary">수정</a>
                    {% endif %}
                </div>
            </li>
            <hr style="height:0.1px">
            {% endfor %}
        </ul>
    </div>

    <div class="t-mt-[1rem] t-text-sm">
        여러분의 소중한 평점 및 영화 관람평을 작성해주세요.<br>
        주제와 무관한 리뷰 또는 스포일러는 표시제한 또는 삭제될 수 있습니다.
    </div>

    <div class="t-mt-[1rem]">
        {% if user.is_authenticated %}
        <form method="POST" action="{% url 'mv:question_create' movie.id %}">
            {% csrf_token %}
            {% bootstrap_form form %}


            <select class="t-mb-3 t-text-black t-ml-[10px] score t-text-yellow-500" name="score" id="score" style="border-radius:5px">
                <option value="1">★</option>
                <option value="2">★★</option>
                <option value="3">★★★</option>
                <option value="4">★★★★</option>
                <option value="5">★★★★★</option>
            </select><br>

            <button type="submit" class="btn btn-danger mb-2 reviewSubmit">
                리뷰 작성
            </button>
            <!--{% bootstrap_button button_type="submit" content="리뷰작성" %}-->
        </form>
        {% endif %}
    </div>
    <br>
    <br>
    </div>
    <script type='text/javascript'>
$(document).ready(function(){
    $(".delete").on('click', function() {
        if(confirm("정말로 삭제하시겠습니까?")) {
            location.href = $(this).data('uri');
        }
    });
    $(".recommend").on('click', function() {
        if(confirm("정말로 추천하시겠습니까?")) {
            location.href = $(this).data('uri');
        }
    });
});
</script>
</section>
{% endblock %}